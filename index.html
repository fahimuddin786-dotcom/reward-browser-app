<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TapEarn - Points Mining App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .wallet {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(255, 215, 0, 0.1);
            padding: 10px 15px;
            border-radius: 15px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .wallet-icon {
            font-size: 20px;
        }

        .wallet-amount {
            font-size: 18px;
            font-weight: bold;
            color: #FFD700;
        }

        .wallet-label {
            font-size: 12px;
            opacity: 0.7;
        }

        .user-info {
            text-align: right;
        }

        .user-level {
            font-size: 14px;
            font-weight: bold;
            color: #CD7F32;
            margin-bottom: 2px;
        }

        .user-stats {
            font-size: 12px;
            opacity: 0.7;
        }

        h2 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 24px;
            background: linear-gradient(45deg, #FFD700, #FFA726);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Main Mining Feature */
        .main-features {
            margin-bottom: 20px;
        }

        .main-feature-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 25px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .main-feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
        }

        .feature-main-icon {
            font-size: 48px;
            margin-bottom: 10px;
            display: block;
        }

        .feature-main-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
            color: white;
        }

        .feature-main-desc {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .mining-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
        }

        .mining-stat {
            text-align: center;
        }

        .mining-value {
            display: block;
            font-size: 16px;
            font-weight: bold;
            color: #FFD700;
            margin-bottom: 2px;
        }

        .mining-label {
            font-size: 12px;
            opacity: 0.8;
        }

        /* Quick Actions Mini */
        .quick-actions-mini {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .mini-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 12px 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            backdrop-filter: blur(10px);
        }

        .mini-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .mini-icon {
            font-size: 20px;
        }

        .mini-text {
            font-size: 11px;
            font-weight: 600;
        }

        /* Boost Section */
        .boost-section {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .boost-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .boost-title {
            font-size: 16px;
            font-weight: bold;
            color: #FFD700;
        }

        .boost-progress {
            font-size: 14px;
            opacity: 0.8;
        }

        .boost-bar {
            background: rgba(255, 255, 255, 0.1);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .boost-fill {
            background: linear-gradient(90deg, #FFD700, #FFA726);
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .boost-btn {
            background: linear-gradient(135deg, #FFD700, #FFA726);
            color: #1a1a2e;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            transition: transform 0.3s ease;
        }

        .boost-btn:hover {
            transform: translateY(-2px);
        }

        /* Community Section */
        .community-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .community-header {
            margin-bottom: 10px;
        }

        .community-title {
            font-size: 12px;
            font-weight: bold;
            opacity: 0.7;
            letter-spacing: 1px;
        }

        .community-stats {
            display: flex;
            justify-content: space-around;
        }

        .community-stat {
            text-align: center;
        }

        .community-value {
            display: block;
            font-size: 16px;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 2px;
        }

        .community-label {
            font-size: 11px;
            opacity: 0.7;
        }

        /* Bottom Navigation */
        .bottom-nav {
            display: flex;
            justify-content: space-around;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 10px 5px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 10px;
            transition: all 0.3s ease;
            opacity: 0.7;
        }

        .nav-item.active {
            background: rgba(255, 255, 255, 0.1);
            opacity: 1;
        }

        .nav-item:hover {
            opacity: 1;
        }

        .nav-icon {
            font-size: 18px;
        }

        .nav-text {
            font-size: 10px;
            font-weight: 600;
        }

        /* Stats Grid Mini */
        .stats-grid-mini {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
        }

        .stat-card-mini {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px 8px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-number-mini {
            font-size: 16px;
            font-weight: bold;
            color: #4CAF50;
            display: block;
            margin-bottom: 2px;
        }

        .stat-label-mini {
            font-size: 10px;
            opacity: 0.7;
        }

        /* Welcome Message */
        .welcome-message {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .welcome-message h3 {
            margin-bottom: 15px;
            color: #FFA726;
            font-size: 18px;
        }

        .welcome-note {
            opacity: 0.7;
            font-style: italic;
            margin-top: 10px;
            font-size: 14px;
        }

        /* Mining Active State */
        .mining-active {
            background: linear-gradient(135deg, #4CAF50, #45a049) !important;
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.3) !important;
        }

        .mining-active .feature-main-desc {
            color: #FFD700 !important;
            font-weight: bold;
        }

        /* YouTube Videos Section */
        .search-container {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .search-container input {
            flex: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            font-size: 14px;
            outline: none;
        }

        .search-container button {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.3s;
        }

        .search-container button:hover {
            transform: translateY(-2px);
        }

        .videos-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 15px;
        }

        .video-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .video-card:hover {
            transform: translateY(-5px);
        }

        .thumbnail {
            position: relative;
            width: 100%;
            height: 100px;
            overflow: hidden;
        }

        .thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .points-badge {
            position: absolute;
            top: 5px;
            left: 5px;
            background: #4CAF50;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: bold;
        }

        .youtube-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #FF0000;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 9px;
        }

        .video-details {
            padding: 10px;
        }

        .video-title {
            font-size: 12px;
            margin-bottom: 6px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.3;
        }

        .video-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 10px;
            opacity: 0.8;
        }

        .watch-now {
            color: #4CAF50;
            font-weight: bold;
        }

        /* Video Player Interface */
        .video-player-interface {
            max-width: 400px;
            margin: 0 auto;
        }

        .player-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .youtube-iframe-container {
            position: relative;
            width: 100%;
            height: 220px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
            background: #000;
        }

        .youtube-iframe-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .video-timer {
            text-align: center;
            padding: 10px;
            background: rgba(255, 165, 0, 0.2);
            border-radius: 8px;
            border: 1px solid #FFA726;
            margin-bottom: 15px;
        }

        .tracking-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
        }

        .tracking-status {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4CAF50;
            animation: pulse 2s infinite;
        }

        .status-text {
            font-weight: bold;
            font-size: 14px;
        }

        .progress-container {
            margin-bottom: 15px;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.3);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-fill {
            background: linear-gradient(90deg, #4CAF50, #45a049);
            height: 100%;
            width: 0%;
            transition: width 0.3s;
        }

        .progress-text {
            font-size: 12px;
            text-align: center;
            opacity: 0.8;
        }

        .tracking-controls {
            display: flex;
            gap: 10px;
        }

        .cancel-btn {
            background: #FF6B6B;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 14px;
        }

        .instructions-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
        }

        .instruction-list {
            margin: 10px 0;
        }

        .instruction {
            padding: 6px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 12px;
        }

        .instruction:last-child {
            border-bottom: none;
        }

        .warning-note {
            background: rgba(255, 165, 0, 0.2);
            border: 1px solid #FFA726;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            text-align: center;
            font-size: 12px;
        }

        /* Loading Spinner */
        .loading {
            text-align: center;
            padding: 30px 20px;
        }

        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 3px solid white;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        /* Earning Success */
        .earning-success {
            text-align: center;
            padding: 20px 15px;
        }

        .success-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .points-earned-large {
            font-size: 36px;
            font-weight: bold;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin: 15px 0;
        }

        .success-details {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: left;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 12px;
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-label {
            opacity: 0.8;
        }

        .detail-value {
            font-weight: bold;
        }

        .success-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 15px;
        }

        .continue-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 12px 16px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            max-width: 280px;
            animation: slideIn 0.3s ease-out;
        }

        .notification.success {
            border-left: 4px solid #4CAF50;
        }

        .notification.info {
            border-left: 4px solid #2196F3;
        }

        .notification.warning {
            border-left: 4px solid #FFA726;
        }

        .notification-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notification-close {
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            color: #666;
        }

        /* Animations */
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .container {
                padding: 12px;
                margin: 5px;
            }
            
            .quick-actions-mini {
                grid-template-columns: repeat(4, 1fr);
                gap: 8px;
            }
            
            .mini-btn {
                padding: 10px 6px;
            }
            
            .mini-icon {
                font-size: 18px;
            }
            
            .mini-text {
                font-size: 10px;
            }
            
            .bottom-nav {
                padding: 8px 3px;
            }
            
            .nav-item {
                padding: 6px 8px;
            }
            
            .nav-icon {
                font-size: 16px;
            }
            
            .nav-text {
                font-size: 9px;
            }

            .videos-grid {
                grid-template-columns: 1fr;
            }

            .youtube-iframe-container {
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header with Wallet -->
        <div class="header">
            <div class="wallet">
                <span class="wallet-icon">üí∞</span>
                <span class="wallet-amount" id="walletPoints">1,010</span>
                <span class="wallet-label">Points</span>
            </div>
            <div class="user-info">
                <div class="user-level">Bronze</div>
                <div class="user-stats">370/500</div>
            </div>
        </div>

        <h2>üéØ TapEarn</h2>

        <!-- Main Features Grid - Only Mining -->
        <div class="main-features">
            <div class="main-feature-card mining-feature" onclick="toggleMining()">
                <div class="feature-main-icon">‚õèÔ∏è</div>
                <div class="feature-main-title">Points Mining</div>
                <div class="feature-main-desc" id="miningStatusText">Click to start mining</div>
                <div class="mining-stats">
                    <div class="mining-stat">
                        <span class="mining-value" id="miningTime">00:00:00</span>
                        <span class="mining-label">Time</span>
                    </div>
                    <div class="mining-stat">
                        <span class="mining-value" id="miningRate">300/hr</span>
                        <span class="mining-label">Rate</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions-mini">
            <button class="mini-btn" onclick="showVideoSection()">
                <span class="mini-icon">üé¨</span>
                <span class="mini-text">Videos</span>
            </button>
            <button class="mini-btn" onclick="showTasks()">
                <span class="mini-icon">üìã</span>
                <span class="mini-text">Tasks</span>
            </button>
            <button class="mini-btn" onclick="showReferralSystem()">
                <span class="mini-icon">üë•</span>
                <span class="mini-text">Refer</span>
            </button>
            <button class="mini-btn" onclick="showSkills()">
                <span class="mini-icon">‚ö°</span>
                <span class="mini-text">Skills</span>
            </button>
        </div>

        <!-- Boost Section -->
        <div class="boost-section">
            <div class="boost-header">
                <span class="boost-title">Boost</span>
                <span class="boost-progress">498/500</span>
            </div>
            <div class="boost-bar">
                <div class="boost-fill" style="width: 99.6%"></div>
            </div>
            <button class="boost-btn" onclick="claimBoost()">
                üöÄ Claim Boost
            </button>
        </div>

        <!-- Community Section -->
        <div class="community-section">
            <div class="community-header">
                <span class="community-title">POWERED BY COMMUNITY</span>
            </div>
            <div class="community-stats">
                <div class="community-stat">
                    <span class="community-value">+1</span>
                    <span class="community-label">Active</span>
                </div>
                <div class="community-stat">
                    <span class="community-value">10.00</span>
                    <span class="community-label">Rating</span>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <div class="nav-item active" onclick="showDashboard()">
                <span class="nav-icon">üè†</span>
                <span class="nav-text">Earn</span>
            </div>
            <div class="nav-item" onclick="showTasks()">
                <span class="nav-icon">üìã</span>
                <span class="nav-text">Tasks</span>
            </div>
            <div class="nav-item" onclick="showAccount()">
                <span class="nav-icon">üë§</span>
                <span class="nav-text">Account</span>
            </div>
            <div class="nav-item" onclick="showSkills()">
                <span class="nav-icon">‚ö°</span>
                <span class="nav-text">Skills</span>
            </div>
            <div class="nav-item" onclick="showCashier()">
                <span class="nav-icon">üí∞</span>
                <span class="nav-text">Cashier</span>
            </div>
        </div>

        <!-- Results Area -->
        <div id="appContent">
            <div class="welcome-message">
                <div class="stats-grid-mini">
                    <div class="stat-card-mini">
                        <span class="stat-number-mini" id="totalPoints">1,010</span>
                        <span class="stat-label-mini">Total Points</span>
                    </div>
                    <div class="stat-card-mini">
                        <span class="stat-number-mini" id="videosWatched">24</span>
                        <span class="stat-label-mini">Videos</span>
                    </div>
                    <div class="stat-card-mini">
                        <span class="stat-number-mini" id="totalReferrals">3</span>
                        <span class="stat-label-mini">Referrals</span>
                    </div>
                </div>
                <p class="welcome-note">Start mining or complete tasks to earn more points!</p>
            </div>
        </div>
    </div>

    <script>
        // YouTube API Configuration
        const YOUTUBE_API_KEY = 'AIzaSyBATxf5D7ZDeiQ61dbEdzEd4Tq72N713Y8';

        // App State Management
        let isMining = false;
        let miningSeconds = 0;
        let miningInterval;
        let userPoints = 1010;
        let watchedVideos = 24;
        let referrals = 3;
        
        // YouTube Video State
        let currentVideoId = null;
        let currentPoints = 0;
        let currentTitle = '';
        let videoTrackingInterval = null;
        let watchedVideoIds = JSON.parse(localStorage.getItem('watchedVideos')) || [];

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            updateUI();
            console.log('üéØ TapEarn App Initialized with YouTube Videos');
        });

        // Update UI
        function updateUI() {
            document.getElementById('walletPoints').textContent = formatNumber(userPoints);
            document.getElementById('totalPoints').textContent = formatNumber(userPoints);
            document.getElementById('videosWatched').textContent = watchedVideos;
            document.getElementById('totalReferrals').textContent = referrals;
            
            // Update mining time display
            const hours = Math.floor(miningSeconds / 3600);
            const minutes = Math.floor((miningSeconds % 3600) / 60);
            const seconds = miningSeconds % 60;
            document.getElementById('miningTime').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Format numbers with commas
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // Toggle Mining
        function toggleMining() {
            if (isMining) {
                stopMining();
            } else {
                startMining();
            }
        }

        // Start Mining
        function startMining() {
            if (isMining) return;
            
            isMining = true;
            const miningCard = document.querySelector('.main-feature-card');
            miningCard.classList.add('mining-active');
            document.getElementById('miningStatusText').textContent = 'Mining Active - 5 pts/min';
            document.getElementById('miningStatusText').style.color = '#FFD700';
            document.getElementById('miningRate').textContent = '300/hr';
            
            miningInterval = setInterval(() => {
                miningSeconds++;
                
                // Add 5 points every minute
                if (miningSeconds % 60 === 0) {
                    userPoints += 5;
                    updateUI();
                    showNotification('‚õèÔ∏è +5 Points from Mining!', 'success');
                }
                
                // Add bonus every hour
                if (miningSeconds % 3600 === 0) {
                    userPoints += 50;
                    updateUI();
                    showNotification('üéâ +50 Bonus Points! 1 Hour Complete!', 'success');
                }
                
                updateUI();
            }, 1000);
            
            showNotification('‚õèÔ∏è Mining Started! Earning 5 points per minute...', 'success');
        }

        // Stop Mining
        function stopMining() {
            if (!isMining) return;
            
            isMining = false;
            clearInterval(miningInterval);
            const miningCard = document.querySelector('.main-feature-card');
            miningCard.classList.remove('mining-active');
            document.getElementById('miningStatusText').textContent = 'Click to start mining';
            document.getElementById('miningStatusText').style.color = '';
            
            showNotification('‚èπÔ∏è Mining Stopped. Points saved!', 'info');
        }

        // Claim Boost
        function claimBoost() {
            userPoints += 100;
            updateUI();
            showNotification('üöÄ +100 Points! Boost claimed successfully!', 'success');
        }

        // Show Video Section with YouTube Search
        function showVideoSection() {
            document.getElementById('appContent').innerHTML = `
                <div class="video-section">
                    <div class="search-container">
                        <input type="text" id="youtubeSearchInput" placeholder="Search YouTube Shorts..." value="trending shorts">
                        <button onclick="searchYouTubeVideos()">üîç Search</button>
                    </div>
                    <div id="videoResultsContainer">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p>Loading YouTube videos...</p>
                        </div>
                    </div>
                </div>
            `;
            searchYouTubeVideos();
        }

        // Search YouTube Videos
        async function searchYouTubeVideos() {
            const query = document.getElementById('youtubeSearchInput').value.trim() || 'trending shorts';
            const container = document.getElementById('videoResultsContainer');
            
            container.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Searching YouTube for "${query}"...</p>
                </div>
            `;

            try {
                const videos = await searchRealYouTubeVideos(query);
                displayYouTubeVideos(videos, query);
            } catch (error) {
                console.error('YouTube search failed:', error);
                container.innerHTML = `
                    <div class="welcome-message">
                        <h3>‚ùå YouTube Search Failed</h3>
                        <p>Using demo videos instead...</p>
                        <button onclick="showDemoVideos()" style="background: #4CAF50; color: white; border: none; padding: 10px 15px; border-radius: 8px; cursor: pointer; margin-top: 10px;">
                            Show Demo Videos
                        </button>
                    </div>
                `;
            }
        }

        // Search Real YouTube Videos
        async function searchRealYouTubeVideos(query) {
            try {
                console.log('üîç Searching YouTube for:', query);
                
                const response = await fetch(
                    `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&videoDuration=short&q=${encodeURIComponent(query)}&maxResults=8&key=${YOUTUBE_API_KEY}`
                );
                
                if (!response.ok) {
                    throw new Error(`YouTube API error: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('‚úÖ YouTube API Success:', data.items?.length, 'videos found');
                
                if (!data.items || data.items.length === 0) {
                    throw new Error('No videos found');
                }
                
                return data.items;
            } catch (error) {
                console.error('‚ùå YouTube API Error:', error.message);
                throw error;
            }
        }

        // Display YouTube Videos
        function displayYouTubeVideos(videos, query) {
            const container = document.getElementById('videoResultsContainer');
            
            let html = `
                <div style="margin-bottom: 15px; text-align: center;">
                    <h3>üé• YouTube Shorts</h3>
                    <p style="font-size: 12px; opacity: 0.8;">Found ${videos.length} videos for "${query}"</p>
                </div>
                <div class="videos-grid">
            `;
            
            videos.forEach((video, index) => {
                const videoId = video.id.videoId;
                const thumbnail = video.snippet.thumbnails.medium?.url || video.snippet.thumbnails.default.url;
                const title = video.snippet.title;
                const channel = video.snippet.channelTitle;
                const points = calculatePoints(title, index);
                const isWatched = watchedVideoIds.includes(videoId);
                
                html += `
                    <div class="video-card" onclick="selectVideoForEarning('${videoId}', ${points}, '${title.replace(/'/g, "\\'")}', '${channel.replace(/'/g, "\\'")}')">
                        <div class="thumbnail">
                            <img src="${thumbnail}" alt="${title}" onerror="this.src='https://via.placeholder.com/300/667eea/ffffff?text=YouTube+Short'">
                            <div class="points-badge">+${points} pts</div>
                            <div class="youtube-badge">YouTube</div>
                        </div>
                        <div class="video-details">
                            <h4 class="video-title">${title}</h4>
                            <div class="video-meta">
                                <span class="channel">${channel}</span>
                                ${isWatched ? 
                                    '<span class="watch-now">‚úÖ Earned</span>' : 
                                    '<span class="watch-now">‚ñ∂Ô∏è Watch</span>'
                                }
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        // Show Demo Videos Fallback
        function showDemoVideos() {
            const demoVideos = [
                {
                    id: { videoId: 'demo1' },
                    snippet: {
                        title: 'üéµ Trending Music Short 2024',
                        thumbnails: { 
                            medium: { url: 'https://via.placeholder.com/300/FF6B6B/FFFFFF?text=Music+Short' },
                            default: { url: 'https://via.placeholder.com/300/FF6B6B/FFFFFF?text=Music+Short' }
                        },
                        channelTitle: 'Music Channel'
                    }
                },
                {
                    id: { videoId: 'demo2' },
                    snippet: {
                        title: 'üòÇ Funny Comedy Skit',
                        thumbnails: { 
                            medium: { url: 'https://via.placeholder.com/300/4ECDC4/FFFFFF?text=Comedy+Short' },
                            default: { url: 'https://via.placeholder.com/300/4ECDC4/FFFFFF?text=Comedy+Short' }
                        },
                        channelTitle: 'Comedy Central'
                    }
                }
            ];
            
            displayYouTubeVideos(demoVideos, 'demo videos');
        }

        // Calculate Points for Video
        function calculatePoints(title, index) {
            const basePoints = 10;
            const bonus = Math.floor(Math.random() * 6);
            return basePoints + bonus;
        }

        // Select Video for Earning
        function selectVideoForEarning(videoId, points, title, channel) {
            // Check if video already watched
            if (watchedVideoIds.includes(videoId)) {
                showNotification('‚ùå You have already earned points for this video!', 'warning');
                return;
            }
            
            currentVideoId = videoId;
            currentPoints = points;
            currentTitle = title;
            
            document.getElementById('appContent').innerHTML = `
                <div class="video-player-interface">
                    <div class="player-header">
                        <button onclick="showVideoSection()" class="back-btn">‚Üê Back to Search</button>
                        <h3>üéØ Earn Points</h3>
                    </div>
                    
                    <div class="youtube-iframe-container">
                        <iframe 
                            width="100%" 
                            height="100%" 
                            src="https://www.youtube.com/embed/${videoId}?autoplay=1&controls=1" 
                            frameborder="0" 
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                            allowfullscreen>
                        </iframe>
                    </div>
                    
                    <div class="video-timer">
                        <p>‚è∞ <strong>Watch for 1 minute to earn ${points} points</strong></p>
                        <p style="font-size: 12px;">Don't close this page - points awarded automatically</p>
                    </div>
                    
                    <div class="tracking-section">
                        <div class="tracking-status">
                            <div class="status-indicator" id="statusIndicator"></div>
                            <div class="status-text" id="statusText">
                                üéØ Ready to earn ${points} points
                            </div>
                        </div>
                        
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                            <div class="progress-text" id="progressText">
                                Waiting for video completion...
                            </div>
                        </div>
                        
                        <div class="tracking-controls">
                            <button onclick="cancelVideoEarning()" class="cancel-btn">
                                ‚ùå Cancel Earning
                            </button>
                        </div>
                    </div>
                    
                    <div class="instructions-panel">
                        <h4>üì± Important Instructions:</h4>
                        <div class="instruction-list">
                            <div class="instruction">‚úÖ Video is playing on this page</div>
                            <div class="instruction">‚úÖ Watch the video for complete 1 minute</div>
                            <div class="instruction">‚ùå Don't close or minimize this page</div>
                            <div class="instruction">‚ùå Don't refresh or go back</div>
                            <div class="instruction">üí∞ Points automatically after 1 minute</div>
                        </div>
                        
                        <div class="warning-note">
                            <strong>‚ö†Ô∏è Warning:</strong> If you leave this page, you won't get points!
                        </div>
                    </div>
                </div>
            `;
            
            // Start video tracking
            startVideoTracking();
        }

        // Start Video Tracking
        function startVideoTracking() {
            let trackingTime = 0;
            const maxTrackingTime = 60; // 1 minute required
            
            videoTrackingInterval = setInterval(() => {
                trackingTime++;
                updateVideoTrackingProgress(trackingTime, maxTrackingTime);
                
                if (trackingTime >= maxTrackingTime) {
                    clearInterval(videoTrackingInterval);
                    completeVideoEarning();
                }
            }, 1000);
        }

        // Update Video Tracking Progress
        function updateVideoTrackingProgress(current, max) {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const statusText = document.getElementById('statusText');
            
            if (progressFill && progressText) {
                const percentage = (current / max) * 100;
                progressFill.style.width = `${percentage}%`;
                
                const timeLeft = max - current;
                
                if (current < 10) {
                    progressText.innerHTML = `‚è≥ Video started... (${current}s/60s) - ${timeLeft}s left`;
                    statusText.innerHTML = 'üé¨ Video playing...';
                } else if (current < 30) {
                    progressText.innerHTML = `üì∫ Video in progress... (${current}s/60s) - ${timeLeft}s left`;
                    statusText.innerHTML = '‚è±Ô∏è Keep watching...';
                } else if (current < 50) {
                    progressText.innerHTML = `‚úÖ Halfway done... (${current}s/60s) - ${timeLeft}s left`;
                    statusText.innerHTML = 'üí∞ Almost there...';
                } else {
                    progressText.innerHTML = `üéâ Almost done... (${current}s/60s) - ${timeLeft}s left`;
                    statusText.innerHTML = '‚ö° Points coming soon!';
                }
            }
        }

        // Complete Video Earning
        function completeVideoEarning() {
            // Add to watched videos list
            if (currentVideoId && !watchedVideoIds.includes(currentVideoId)) {
                watchedVideoIds.push(currentVideoId);
                localStorage.setItem('watchedVideos', JSON.stringify(watchedVideoIds));
            }
            
            // Add points
            userPoints += currentPoints;
            watchedVideos++;
            updateUI();
            
            // Show success message
            showEarningSuccess();
        }

        // Show Earning Success
        function showEarningSuccess() {
            document.getElementById('appContent').innerHTML = `
                <div class="earning-success">
                    <div class="success-icon">üéâ</div>
                    
                    <h3>Points Earned Successfully!</h3>
                    
                    <div class="points-earned-large">
                        +${currentPoints} Points
                    </div>
                    
                    <div class="success-details">
                        <div class="detail-item">
                            <span class="detail-label">Video:</span>
                            <span class="detail-value">${currentTitle}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Points Added:</span>
                            <span class="detail-value">+${currentPoints}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Total Points:</span>
                            <span class="detail-value">${userPoints}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Watch Time:</span>
                            <span class="detail-value">1 minute complete</span>
                        </div>
                    </div>
                    
                    <div class="success-actions">
                        <button onclick="showVideoSection()" class="continue-btn">
                            üîç Watch More Videos
                        </button>
                        <button onclick="showDashboard()" class="continue-btn" style="background: #667eea;">
                            üè† Back to Dashboard
                        </button>
                    </div>
                </div>
            `;
            
            showNotification(`‚úÖ +${currentPoints} Points earned for 1 minute watch!`, 'success');
        }

        // Cancel Video Earning
        function cancelVideoEarning() {
            if (videoTrackingInterval) {
                clearInterval(videoTrackingInterval);
            }
            showNotification('‚ùå Points earning cancelled - no points added', 'warning');
            showVideoSection();
        }

        // Show Tasks
        function showTasks() {
            document.getElementById('appContent').innerHTML = `
                <div class="welcome-message">
                    <h3>üìã Daily Tasks</h3>
                    <div style="text-align: left; margin: 15px 0;">
                        <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <span>Watch 5 videos</span>
                            <button onclick="completeTask('videos')" style="background: #4CAF50; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px;">+25 pts</button>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <span>Refer 1 friend</span>
                            <button onclick="completeTask('referral')" style="background: #4CAF50; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px;">+50 pts</button>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px 0;">
                            <span>Mine for 1 hour</span>
                            <button onclick="completeTask('mining')" style="background: #4CAF50; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px;">+50 pts</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Complete Task
        function completeTask(task) {
            let points = 0;
            switch(task) {
                case 'videos':
                    points = 25;
                    break;
                case 'referral':
                    points = 50;
                    break;
                case 'mining':
                    points = 50;
                    break;
            }
            
            userPoints += points;
            updateUI();
            showNotification(`‚úÖ +${points} Points! Task completed!`, 'success');
            showTasks();
        }

        // Show Referral System
        function showReferralSystem() {
            document.getElementById('appContent').innerHTML = `
                <div class="welcome-message">
                    <h3>üë• Refer & Earn</h3>
                    <div style="margin: 15px 0;">
                        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-bottom: 15px;">
                            <div style="font-size: 14px; opacity: 0.8; margin-bottom: 5px;">Your Referral Code</div>
                            <div style="font-size: 24px; font-weight: bold; color: #FFD700; letter-spacing: 2px;">TAPEARN123</div>
                        </div>
                        <button onclick="copyReferralCode()" style="background: #2196F3; color: white; border: none; padding: 12px 20px; border-radius: 10px; cursor: pointer; width: 100%; margin-bottom: 10px;">
                            üìã Copy Code
                        </button>
                        <button onclick="addReferral()" style="background: #4CAF50; color: white; border: none; padding: 12px 20px; border-radius: 10px; cursor: pointer; width: 100%;">
                            üë• + Add Referral
                        </button>
                    </div>
                </div>
            `;
        }

        // Add Referral
        function addReferral() {
            referrals++;
            userPoints += 50;
            updateUI();
            showNotification('üéâ +50 Points! New referral added!', 'success');
            showDashboard();
        }

        // Copy Referral Code
        function copyReferralCode() {
            navigator.clipboard.writeText('TAPEARN123');
            showNotification('‚úÖ Referral code copied!', 'success');
        }

        // Show Skills
        function showSkills() {
            document.getElementById('appContent').innerHTML = `
                <div class="welcome-message">
                    <h3>‚ö° Skills</h3>
                    <p>Upgrade your mining power and earning rate!</p>
                    <div style="text-align: left; margin: 15px 0;">
                        <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <span>Mining Speed</span>
                            <button onclick="upgradeSkill('mining')" style="background: #FFA726; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px;">Upgrade</button>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <span>Video Rewards</span>
                            <button onclick="upgradeSkill('video')" style="background: #FFA726; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px;">Upgrade</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Upgrade Skill
        function upgradeSkill(skill) {
            if (userPoints >= 100) {
                userPoints -= 100;
                updateUI();
                showNotification('‚ö° Skill upgraded! Earning rate increased!', 'success');
            } else {
                showNotification('‚ùå Not enough points! Need 100 points.', 'warning');
            }
        }

        // Show Account
        function showAccount() {
            document.getElementById('appContent').innerHTML = `
                <div class="welcome-message">
                    <h3>üë§ Account</h3>
                    <div style="text-align: left; margin: 15px 0;">
                        <div style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <div style="font-size: 12px; opacity: 0.8;">Username</div>
                            <div style="font-weight: bold;">TapEarn User</div>
                        </div>
                        <div style="padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <div style="font-size: 12px; opacity: 0.8;">Level</div>
                            <div style="font-weight: bold; color: #CD7F32;">Bronze</div>
                        </div>
                        <div style="padding: 10px 0;">
                            <div style="font-size: 12px; opacity: 0.8;">Member Since</div>
                            <div style="font-weight: bold;">2024</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Show Cashier
        function showCashier() {
            document.getElementById('appContent').innerHTML = `
                <div class="welcome-message">
                    <h3>üí∞ Cashier</h3>
                    <p>Redeem your points for rewards!</p>
                    <div style="text-align: left; margin: 15px 0;">
                        <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <span>Amazon Gift Card</span>
                            <button onclick="redeemReward('amazon')" style="background: #FFA726; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px;">1000 pts</button>
                        </div>
                        <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1);">
                            <span>PayPal Cash</span>
                            <button onclick="redeemReward('paypal')" style="background: #FFA726; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 12px;">5000 pts</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Redeem Reward
        function redeemReward(reward) {
            let cost = reward === 'amazon' ? 1000 : 5000;
            if (userPoints >= cost) {
                userPoints -= cost;
                updateUI();
                showNotification(`üéâ Reward redeemed successfully! ${reward.toUpperCase()} gift card sent!`, 'success');
            } else {
                showNotification(`‚ùå Not enough points! Need ${cost} points.`, 'warning');
            }
        }

        // Show Dashboard
        function showDashboard() {
            document.getElementById('appContent').innerHTML = `
                <div class="welcome-message">
                    <div class="stats-grid-mini">
                        <div class="stat-card-mini">
                            <span class="stat-number-mini">${formatNumber(userPoints)}</span>
                            <span class="stat-label-mini">Total Points</span>
                        </div>
                        <div class="stat-card-mini">
                            <span class="stat-number-mini">${watchedVideos}</span>
                            <span class="stat-label-mini">Videos</span>
                        </div>
                        <div class="stat-card-mini">
                            <span class="stat-number-mini">${referrals}</span>
                            <span class="stat-label-mini">Referrals</span>
                        </div>
                    </div>
                    <p class="welcome-note">Start mining or complete tasks to earn more points!</p>
                </div>
            `;
        }

        // Notification System
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-message">${message}</span>
                    <button class="notification-close" onclick="this.parentElement.parentElement.remove()">√ó</button>
                </div>
            `;
            document.body.appendChild(notification);
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 4000);
        }
    </script>
</body>
</html>
